{"version":21,"variables":[{"version":2,"key":"hostname","type":"query","visible":true,"editable":true,"input":"timeseries status = avg(windows.security.compliance.status), by: {host.name}\n| fields host.name","multiple":true}],"tiles":{"0":{"type":"markdown","content":"## ðŸ‡¦ðŸ‡º Essential 8 Compliance Dashboard\n\n### Australian Cyber Security Centre (ACSC) Maturity Model\n\nMonitoring **Essential 8** security controls for cyber resilience:\n\n**ðŸ“š Official Documentation:**\n- [Essential 8 Overview](https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/essential-eight)\n- [Essential 8 Maturity Model](https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/essential-eight/essential-eight-maturity-model)\n- [Implementation Guidance](https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/essential-eight/essential-eight-assessment-process-guide)\n- [Windows Hardening Guide](https://www.cyber.gov.au/resources-business-and-systems/system-hardening-and-administration/system-hardening/hardening-microsoft-windows-10-and-windows-11-workstations)\n\n**ðŸŽ¯ The Eight Strategies:**\n1. Application control\n2. Patch applications\n3. Configure Microsoft Office macro settings\n4. User application hardening\n5. Restrict administrative privileges\n6. Patch operating systems\n7. Multi-factor authentication\n8. Regular backups","title":""},"2":{"title":"","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, current_value, expected_value, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    severity = first(severity)\n  }, by: {control_name, control_id, host.name}\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| summarize count = count(), by:{severity}\n| filter severity == \"Critical\"","visualization":"singleValue","visualizationSettings":{"autoSelectVisualization":false,"singleValue":{"labelMode":"data","recordLabel":"severity","colorThresholdTarget":"background"},"thresholds":[{"id":1,"field":"count","isEnabled":true,"rules":[{"id":1,"color":"#800011","comparator":">","value":0}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"4":{"title":"ðŸš¨ Critical & High Severity Essential 8 Issues","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, control_category, current_value, expected_value, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    severity = first(severity),\n    control_category = first(control_category)\n  }, by: {control_name, control_id, host.name}\n| filter contains(severity,\"Critical\") OR contains(severity,\"High\")\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| fields control_name, severity, control_category, current_value, expected_value, status, host.name\n| sort severity asc","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true,"columnWidths":{"[\"current_value\"]":139.3,"[\"status\"]":186.4,"[\"host.name\"]":247.4,"[\"severity\"]":77.69}},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"5":{"title":"All Essential 8 Controls","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_id, control_name, control_category, severity, control_frameworks, current_value, expected_value, registry_path, host.name}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    severity = first(severity),\n    control_category = first(control_category),\n    control_frameworks = first(control_frameworks),\n    registry_path = first(registry_path)\n  }, by: {control_name, control_id, host.name}\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| fields control_id, control_name, control_category, severity, control_frameworks, current_value, expected_value, registry_path, status, host.name","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true,"columnWidths":{"[\"control_category\"]":160.39,"[\"host.name\"]":232.4,"[\"status\"]":153.4,"[\"registry_path\"]":728,"[\"control_id\"]":223.89},"sortBy":[{"columnId":"[\"control_id\"]","direction":"descending"}]},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"},{"id":2,"color":{"Default":"#006650"},"comparator":"=","value":"COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"6":{"title":"Application Control & Hardening","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, current_value, expected_value, registry_path, control_category, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    control_category = first(control_category),\n    registry_path = first(registry_path)\n  }, by: {control_name, control_id, host.name}\n| filter control_category == \"ApplicationControl\" OR control_category == \"OfficeSecuirty\"\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| fields control_name, current_value, expected_value, registry_path, status, host.name","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true,"columnWidths":{"[\"host.name\"]":235.4}},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"},{"id":2,"color":{"Default":"#006650"},"comparator":"=","value":"COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"7":{"title":"Authentication & Access Control","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, current_value, expected_value, control_category, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    control_category = first(control_category)\n  }, by: {control_name, control_id, host.name}\n| filter control_category == \"Authentication\" OR control_category == \"Network\"\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| fields control_name, current_value, expected_value, status, host.name","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true,"columnWidths":{"[\"control_name\"]":212.9}},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"},{"id":2,"color":{"Default":"#006650"},"comparator":"=","value":"COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"8":{"title":"Anti-Malware & Protection","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, current_value, expected_value, control_category, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    control_category = first(control_category)\n  }, by: {control_name, control_id, host.name}\n| filter control_category == \"AntiMalware\"\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| fields control_name, current_value, expected_value, status, host.name","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"},{"id":2,"color":{"Default":"#006650"},"comparator":"=","value":"COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"9":{"title":"Encryption & Data Protection","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, current_value, expected_value, control_category, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    control_category = first(control_category)\n  }, by: {control_name, control_id, host.name}\n| filter control_category == \"Encryption\" OR control_category == \"CredentialProtection\"\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| fields control_name, current_value, expected_value, status, host.name\n","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"},{"id":2,"color":{"Default":"#006650"},"comparator":"=","value":"COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"12":{"title":"ðŸ“„ Recently Changed Essential 8 Controls (Last 7 days)","type":"data","query":"timeseries status = count(windows.security.compliance.status), by: {control_id, control_name, severity, control_category, current_value, expected_value, host.name, control_frameworks}, interval: 15m, from: now()-7d\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| fieldsAdd status_text = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| summarize \n    status_changes = countDistinct(status_text),\n    first_status = last(status_text),\n    latest_status = first(status_text),\n    by: {control_id, control_name, severity, control_category, host.name }\n| filter status_changes > 1 \n| fieldsAdd change_direction = if(latest_status == \"COMPLIANT\", then: \"âœ… FIXED\", else: \"âš ï¸ BROKEN\")\n| fields control_id, control_name, severity, control_category, first_status, latest_status, change_direction, host.name\n| sort change_direction desc","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true,"columnWidths":{"[\"control_id\"]":230.39,"[\"host.name\"]":217.4,"[\"latest_status\"]":141.4},"sortBy":[{"columnId":"[\"control_name\"]","direction":"descending"}]},"thresholds":[{"id":1,"field":"change_direction","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#006650"},"comparator":"=","value":"âœ… FIXED"},{"id":2,"color":{"Default":"#ae132d"},"comparator":"=","value":"âš ï¸ BROKEN"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"13":{"title":"","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, current_value, expected_value, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    severity = first(severity)\n  }, by: {control_name, control_id, host.name}\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| summarize count = count(), by:{severity}\n| filter severity == \"High\"","visualization":"singleValue","visualizationSettings":{"autoSelectVisualization":false,"singleValue":{"labelMode":"data","recordLabel":"severity","colorThresholdTarget":"background"},"thresholds":[{"id":1,"field":"count","isEnabled":true,"rules":[{"id":1,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":">","value":0}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"14":{"title":"","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, current_value, expected_value, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    severity = first(severity)\n  }, by: {control_name, control_id, host.name}\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| summarize count = count(), by:{severity}\n| filter severity == \"Medium\"","visualization":"singleValue","visualizationSettings":{"autoSelectVisualization":false,"singleValue":{"labelMode":"data","recordLabel":"severity","colorThresholdTarget":"background"},"thresholds":[{"id":1,"field":"count","isEnabled":true,"rules":[{"id":1,"color":{"Default":"var(--dt-colors-charts-apdex-poor-default, #d56b1a)"},"comparator":">","value":0}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"15":{"title":"","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, current_value, expected_value, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value),\n    severity = first(severity)\n  }, by: {control_name, control_id, host.name}\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| summarize count = count(), by:{severity}\n| filter severity == \"Low\"","visualization":"singleValue","visualizationSettings":{"autoSelectVisualization":false,"singleValue":{"labelMode":"data","recordLabel":"severity","colorThresholdTarget":"background"},"thresholds":[{"id":1,"field":"count","isEnabled":true,"rules":[{"id":1,"color":"#FDBE2B","comparator":">","value":0}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"16":{"type":"markdown","content":"# Essential 8 Non-Compliant Controls"},"17":{"type":"markdown","content":"## Status Legend\n- ðŸŸ¢ **Compliant**: Control configured correctly per ACSC guidance\n- ðŸ”´ **Non-Compliant**: Security violation - remediation required\n- âšª **Not Configured**: Registry key not found\n\n### Maturity Levels\nThe Essential 8 uses a maturity model from Level 1 (basic) to Level 3 (advanced protection)","title":""},"18":{"type":"markdown","content":"## ðŸ” Essential 8 Control Categories\n\n**Strategy Mapping:**\n- **ApplicationControl**: Prevent execution of unapproved programs\n- **OfficeSecuirty**: Configure Office macro settings\n- **Authentication**: Multi-factor authentication\n- **Network**: Restrict admin privileges & network segmentation\n- **AntiMalware**: Windows Defender configuration\n- **Encryption**: BitLocker & credential protection\n- **CredentialProtection**: LSA protection, Credential Guard\n\n**Note:** Some controls like \"Cached Credentials\" may show as non-compliant even when configured securely (e.g., value of 1 is more secure than 2 per ACSC guidance).","title":""},"19":{"title":"ðŸ“Š Essential 8 Compliance Overview","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, current_value, expected_value, host.name, control_frameworks, control_id}\n| filter contains(control_frameworks, \"Essential8\")\n| filter matchesValue(host.name,$hostname)\n| summarize {\n    current_value = first(current_value),\n    expected_value = first(expected_value)\n  }, by: {control_name, control_id, host.name}\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| summarize \n    total_controls = count(),\n    compliant = countIf(status == \"COMPLIANT\"),\n    non_compliant = countIf(status == \"NON-COMPLIANT\"),\n    by: {host.name}\n| fieldsAdd compliance_percentage = (toDouble(compliant)/toDouble(total_controls)) * 100\n| sort compliance_percentage asc","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true,"columnWidths":{"[\"total_controls\"]":118.4}},"thresholds":[{"id":1,"field":"compliance_percentage","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#006650"},"comparator":">=","value":90},{"id":2,"color":{"Default":"#d56b1a"},"comparator":">=","value":70},{"id":3,"color":{"Default":"#ae132d"},"comparator":"<","value":70}]}],"unitsOverrides":[{"identifier":"compliance_percentage","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1769739248982}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}}},"layouts":{"0":{"x":0,"y":0,"w":10,"h":10},"2":{"x":16,"y":1,"w":2,"h":3},"4":{"x":0,"y":19,"w":24,"h":12},"5":{"x":0,"y":43,"w":24,"h":16},"6":{"x":0,"y":31,"w":12,"h":6},"7":{"x":12,"y":31,"w":12,"h":6},"8":{"x":0,"y":37,"w":12,"h":6},"9":{"x":12,"y":37,"w":12,"h":6},"12":{"x":0,"y":13,"w":24,"h":6},"13":{"x":18,"y":1,"w":2,"h":3},"14":{"x":20,"y":1,"w":2,"h":3},"15":{"x":22,"y":1,"w":2,"h":3},"16":{"x":16,"y":0,"w":8,"h":1},"17":{"x":10,"y":0,"w":6,"h":7},"18":{"x":16,"y":4,"w":8,"h":6},"19":{"x":0,"y":10,"w":24,"h":3}},"importedWithCode":false,"settings":{},"annotations":[]}
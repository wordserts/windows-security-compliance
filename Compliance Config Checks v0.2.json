{"version":21,"variables":[{"version":2,"key":"hostname","type":"query","visible":true,"editable":true,"input":"timeseries status = avg(windows.security.compliance.status), by: {host.name}\n| fields host.name","multiple":true}],"tiles":{"0":{"type":"markdown","content":"## ðŸ›¡ï¸ Windows Security Compliance Dashboard\n\nMonitoring **30 security controls** across multiple frameworks:\n- **CIS Benchmarks** - Industry best practices\n- **Essential 8** - Australian Cyber Security Centre\n- **PCI-DSS v4.0** - Payment card security\n","title":""},"2":{"title":"","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, current_value, expected_value, host.name}\n| fields severity, current_value, expected_value, host.name\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| filter matchesValue(host.name,$hostname)\n| summarize count = count(), by:{severity}\n| filter severity == \"Critical\"","visualization":"singleValue","visualizationSettings":{"autoSelectVisualization":false,"singleValue":{"labelMode":"data","recordLabel":"severity","colorThresholdTarget":"background"},"thresholds":[{"id":1,"field":"count","isEnabled":true,"rules":[{"id":1,"color":"#800011","comparator":">","value":0}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"4":{"title":"ðŸš¨ Critical & High Severity Issues","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, control_category, current_value, expected_value, host.name}\n| filter contains(severity,\"Critical\") OR contains(severity,\"High\")\n| fields control_name, severity, control_category, current_value, expected_value, host.name\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| filter matchesValue(host.name,$hostname)\n| sort severity asc","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true,"columnWidths":{"[\"current_value\"]":139.3,"[\"status\"]":186.4,"[\"host.name\"]":247.4,"[\"severity\"]":77.69}},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"5":{"title":"All Compliance Controls","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_id, control_name, control_category, severity, control_frameworks, current_value, expected_value, registry_path, host.name}\n| fields control_id, control_name, control_category, severity, control_frameworks, current_value, expected_value, registry_path, host.name\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter matchesValue(host.name,$hostname)","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true,"columnWidths":{"[\"control_category\"]":160.39,"[\"host.name\"]":232.4,"[\"status\"]":153.4,"[\"control_id\"]":250.6,"[\"control_name\"]":334.9,"[\"severity\"]":108.7,"[\"control_frameworks\"]":174.2,"[\"current_value\"]":176.4},"sortBy":[{"columnId":"[\"control_id\"]","direction":"descending"}]},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"},{"id":2,"color":{"Default":"#006650"},"comparator":"=","value":"COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"6":{"title":"Authentication Controls","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, current_value, expected_value, registry_path, control_category, host.name}\n| filter control_category == \"Authentication\"\n| fields control_name, current_value, expected_value, registry_path, host.name\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter matchesValue(host.name,$hostname)","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"},{"id":2,"color":{"Default":"#006650"},"comparator":"=","value":"COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"7":{"title":"Network Security Controls","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, current_value, expected_value, control_category, host.name}\n| filter control_category == \"Network\"\n| fields control_name, current_value, expected_value, host.name\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter matchesValue(host.name,$hostname)","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true},"thresholds":[{"id":1,"field":"status","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#ae132d"},"comparator":"=","value":"NON-COMPLIANT"},{"id":2,"color":{"Default":"#006650"},"comparator":"=","value":"COMPLIANT"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"12":{"title":"ðŸ”„ Recently Changed Controls (Last 7d)","type":"data","query":"timeseries status = count(windows.security.compliance.status), by: {control_id, control_name, severity, control_category, current_value, expected_value, host.name}, interval: 15m, from: now()-7d\n| filter matchesValue(host.name,$hostname)\n| fieldsAdd status_text = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| summarize \n    status_changes = countDistinct(status_text),\n    first_status = last(status_text),      // â† SWAPPED: last() gets the oldest value\n    latest_status = first(status_text),    // â† SWAPPED: first() gets the newest value\n    by: {control_id, control_name, severity, control_category, host.name }\n| filter status_changes > 1 \n| fieldsAdd change_direction = if(latest_status == \"COMPLIANT\", then: \"âœ… FIXED\", else: \"âš ï¸ BROKEN\")\n| fields control_id, control_name, severity, control_category, first_status, latest_status, change_direction, host.name\n| sort change_direction desc\n","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","enableThresholdInRow":true,"columnWidths":{"[\"control_id\"]":163.4,"[\"host.name\"]":251.4,"[\"latest_status\"]":141.4,"[\"change_direction\"]":154.4},"sortBy":[{"columnId":"[\"control_name\"]","direction":"descending"}]},"thresholds":[{"id":1,"field":"change_direction","isEnabled":true,"rules":[{"id":1,"color":{"Default":"#006650"},"comparator":"=","value":"âœ… FIXED"},{"id":2,"color":{"Default":"#ae132d"},"comparator":"=","value":"âš ï¸ BROKEN"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"13":{"title":"","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, current_value, expected_value, host.name}\n| fields severity, current_value, expected_value, host.name\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| filter matchesValue(host.name,$hostname)\n| summarize count = count(), by:{severity}\n| filter severity == \"High\"","visualization":"singleValue","visualizationSettings":{"autoSelectVisualization":false,"singleValue":{"labelMode":"data","recordLabel":"severity","colorThresholdTarget":"background"},"thresholds":[{"id":1,"field":"count","isEnabled":true,"rules":[{"id":1,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":">","value":0}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"14":{"title":"","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, current_value, expected_value, host.name}\n| fields severity, current_value, expected_value, host.name\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| filter matchesValue(host.name,$hostname)\n| summarize count = count(), by:{severity}\n| filter severity == \"Medium\"","visualization":"singleValue","visualizationSettings":{"autoSelectVisualization":false,"singleValue":{"labelMode":"data","recordLabel":"severity","colorThresholdTarget":"background"},"thresholds":[{"id":1,"field":"count","isEnabled":true,"rules":[{"id":1,"color":{"Default":"var(--dt-colors-charts-apdex-poor-default, #d56b1a)"},"comparator":">","value":0}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"15":{"title":"","type":"data","query":"timeseries status = avg(windows.security.compliance.status), by: {control_name, severity, current_value, expected_value, host.name}\n| fields severity, current_value, expected_value, host.name\n| fieldsAdd status = if(current_value == expected_value, then: \"COMPLIANT\", else: \"NON-COMPLIANT\")\n| filter status != \"COMPLIANT\"\n| filter matchesValue(host.name,$hostname)\n| summarize count = count(), by:{severity}\n| filter severity == \"Low\"","visualization":"singleValue","visualizationSettings":{"autoSelectVisualization":false,"singleValue":{"labelMode":"data","recordLabel":"severity","colorThresholdTarget":"background"},"thresholds":[{"id":1,"field":"count","isEnabled":true,"rules":[{"id":1,"color":"#FDBE2B","comparator":">","value":0}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{"isAvailable":true}}},"16":{"type":"markdown","content":"# Non-Compliant Controls Summary"},"17":{"type":"markdown","content":"## Status Legend\n- ðŸŸ¢ **Compliant**: Control configured correctly\n- ðŸ”´ **Non-Compliant**: Security violation detected\n- âšª **Not Configured**: Registry key not found","title":""}},"layouts":{"0":{"x":0,"y":0,"w":6,"h":5},"2":{"x":14,"y":1,"w":2,"h":3},"4":{"x":0,"y":5,"w":24,"h":14},"5":{"x":0,"y":33,"w":24,"h":17},"6":{"x":0,"y":25,"w":12,"h":8},"7":{"x":12,"y":25,"w":12,"h":8},"12":{"x":0,"y":19,"w":24,"h":6},"13":{"x":16,"y":1,"w":2,"h":3},"14":{"x":18,"y":1,"w":2,"h":3},"15":{"x":20,"y":1,"w":2,"h":3},"16":{"x":14,"y":0,"w":8,"h":1},"17":{"x":6,"y":0,"w":4,"h":5}},"importedWithCode":false,"settings":{},"annotations":[]}